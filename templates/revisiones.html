{% extends "base.html" %}

{% block title %}Revisiones{% endblock %}

{% block body_class %}body-bg-revisiones{% endblock %}

{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2><i class="fas fa-wrench"></i> Lista de Revisiones</h2>
    <a href="{{ url_for('agregar_revision') }}" class="btn btn-primary">
      <i class="fas fa-plus-circle"></i> Agregar Revisión
    </a>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered table-hover align-middle">
      <thead class="table-dark">
        <tr>
          <th scope="col">ID Revisión</th>
          <th scope="col">Matrícula</th>
          <th scope="col">Marca / Modelo</th>
          <th scope="col">Cliente</th>
          <th scope="col">Fecha</th>
          <th scope="col">Kilometraje</th>
          <th scope="col">Descripción</th>
          <th scope="col">Importe</th>
          <th scope="col">Acciones</th>
        </tr>
      </thead>
      <tbody>
        {% for revision in revisiones %}
        <tr>
          <td>{{ revision.codigo }}</td>
          <td>{{ revision.matricula_coche }}</td>
          <td>{{ revision.marca }} {{ revision.modelo }}</td>
          <td>{{ revision.nombre_cliente }}</td>
          <td>{{ revision.fecha_revision.strftime('%Y-%m-%d') if revision.fecha_revision else 'N/A' }}</td>
          <td>{{ '{:,.0f}'.format(revision.kilometraje) }} km</td>
          <td>{{ revision.descripcion }}</td>
          <td>${{ '{:,.2f}'.format(revision.importe) }}</td>
          <td>
            <a href="{{ url_for('editar_revision', codigo=revision.codigo) }}" class="btn btn-warning btn-sm">
              <i class="fas fa-edit"></i> Editar
            </a>
            <a href="{{ url_for('eliminar_revision', codigo=revision.codigo) }}" class="btn btn-danger btn-sm" onclick="return confirm('¿Estás seguro de que quieres eliminar esta revisión?');">
              <i class="fas fa-trash-alt"></i> Eliminar
            </a>
          </td>
        </tr>
        {% else %}
        <tr>
          <td colspan="9" class="text-center">No hay revisiones registradas.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
{% endblock %}
